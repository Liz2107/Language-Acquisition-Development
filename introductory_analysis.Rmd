---
title: "Exploratory Analysis of Wordbank Data"
author: "Peyton Barger, Mauricio Bell, Liz Cutting"
date: "2 October 2025"
output:
  pdf_document: default
---

```{r setup, include=FALSE, message=FALSE,warning=FALSE}
library(knitr)
library(tinytex)
library(tidyverse)
library(dplyr)

knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(out.width = "60%",fig.align='center')
```

We want data that has a lot of points and examples of bilinguality and differing developmental patterns. 

```{r}
data <- read_csv("wordbank_administration_data.csv")

glimpse(data)

```


```{r}
data %>%
  count(typically_developing)
data %>%
  count(monolingual)
data %>%
  count(is_norming)
data %>%
  count(age)
data %>%
  count(birth_order)
data %>%
  count(sex)
data %>%
  count(race)
data %>%
  count(caregiver_education)
```


```{r}
words <- read.csv("wordbank_instrument_data.csv")

tot_words <- words %>%
  group_by(child_id) %>%
  summarise(unique_count = n_distinct(english_gloss[value == "produces"]))

print(tot_words)
```


Beyond this, we want to check that our child_ids match up:
```{r}
unique_child_ids_words <- unique(words$child_id)
unique_child_ids_data <- unique(data$child_id)

# Check if any child_id from 'words' is missing in 'data' and vice versa
missing_in_data <- setdiff(unique_child_ids_words, unique_child_ids_data)
missing_in_words <- setdiff(unique_child_ids_data, unique_child_ids_words)
```
We have a lot missing, but we still have plenty to do the analysis with. 
Now we join the data:
```{r}
data_with_word_count <- data %>%
  left_join(tot_words, by = "child_id")

data_with_valid_counts <- data_with_word_count %>%
  filter(!is.na(unique_count))

print(data_with_valid_counts)

```


```{r}
data_with_valid_counts %>%
  count(typically_developing)
data_with_valid_counts %>%
  count(monolingual)
data_with_valid_counts %>%
  count(is_norming)
data_with_valid_counts %>%
  count(age)
data_with_valid_counts %>%
  count(birth_order)
data_with_valid_counts %>%
  count(sex)
data_with_valid_counts %>%
  count(race)
data_with_valid_counts %>%
  count(caregiver_education)
```
```{r}
long_data <- data_with_valid_counts %>%
  select(typically_developing, monolingual, is_norming) %>%
  mutate(across(everything(), as.character)) %>% 
  pivot_longer(
    cols = everything(), 
    names_to = "variable",
    values_to = "value" 
  )

value_counts <- long_data %>%
  group_by(variable, value) %>%
  summarise(count = n(), .groups = "drop")

plot <- ggplot(value_counts, aes(x = reorder(value, -count), y = count, fill = value)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  facet_wrap(~ variable, scales = "free_x") +
  theme_minimal() +
  labs(x = "Category", y = "Count", title = "Distribution of Categorical Variables") +
  theme(axis.text.x = element_text())

```
```{r}
ggsave("dist_resp+preds.png", plot = plot, width = 7, height = 5, units = "in", dpi = 300)
```
```{r}
ggplot(data_with_valid_counts, aes(x = age, y = unique_count)) +
  geom_point() +
  labs(x = "Category", y = "Count", title = "Distribution of Categorical Variables") 
```
```{r}
data_with_valid_counts$age_category <- cut(data_with_valid_counts$age,
                                           breaks = c(7, 12, 20, 30), 
                                           labels = c("8-12", "12-20", "20-30"),
                                           right = TRUE)

data_with_valid_counts$age_category <- factor(data_with_valid_counts$age_category,
                                              levels = c("8-12", "12-20", "20-30"))

plot2 <- ggplot(data_with_valid_counts, aes(x = age_category, y = unique_count, fill = age_category)) +
  geom_boxplot() +
  scale_fill_manual(values = c("8-12" = "#FF6347", "12-20" = "#3CB371", "20-30" = "#1E90FF")) +
  labs(x = "Age Range (months)", y = "Number of Words Learned", title = "Distribution of Words Learned by Age Range")

ggsave("dist_age_v_words.png", plot = plot2, width = 7, height = 5, units = "in", dpi = 300)

```




Filling in our chart: 
```{r}
median(data_with_valid_counts$comprehension)
median(data_with_valid_counts$age)
median(data_with_valid_counts$production)
median(data_with_valid_counts$unique_count)

sd(data_with_valid_counts$comprehension)
sd(data_with_valid_counts$age)
sd(data_with_valid_counts$production)

max(data_with_valid_counts$comprehension)
min(data_with_valid_counts$comprehension)

max(data_with_valid_counts$age)
min(data_with_valid_counts$age)

max(data_with_valid_counts$production)
min(data_with_valid_counts$production)

max(data_with_valid_counts$unique_count)
min(data_with_valid_counts$unique_count)
```

